{
  "start": {
    "name": "StateUnreadWelcome",
    "transitions": [{
      "trigger": "OnReadWelcome",
      "target": "StateWelcomed"
    }],
    "actions": [{
      "name": "ActionSendWelcomeNotification",
      "notificationTemplate":"welcomeMessage"
    }]
  },
  "states": [
    {
      "name": "StateUnreadWelcome",
      "transitions": [{
        "trigger": "OnReadWelcome",
        "target": "StateWelcomed"
      }],
      "actions": [{
        "name": "ActionSendWelcomeNotification",
        "notificationTemplate":"welcomeMessage"
      }]
    },
    {
      "name": "StateWelcomed",
      "transitions": [{
        "trigger": "OnReadInformDevicesAvailable",
        "target": "StateInformedDevicesAvailable"
      }],
      "actions": [{
        "name": "ActionSendInformDevicesAvailable",
        "notificationTemplate":"devicesAvailable"
      }]
    },
    {
      "name": "StateInformedDevicesAvailable",
      "transitions": [{
        "trigger": "OnReadInformCanMakeAppointments",
        "target": "StateInformedCanMakeAppointments"
      }],
      "actions": [{
        "name": "ActionSendInformCanMakeAppointments",
        "notificationTemplate":"canMakeAppointment"
      }]
    },
    {
      "name": "StateInformedCanMakeAppointments",
      "transitions": [{
        "trigger": "OnReadInformProvideDetails",
        "target": "StateAwaitingProvideDetails"
      }],
      "actions": [{
        "name": "ActionSendInformProvideDetails",
        "notificationTemplate":"provideDetails"
      }]
    },
    {
      "name": "StateAwaitingProvideDetails",
      "transitions": [{
        "trigger": "OnProvideDetails",
        "target": "StateIdle"
      }]
    },
    {
      "name": "StateIdle",
      "transitions": [{
        "trigger": "OnAppointmentBooking",
        "target": "StateAppointmentBooked"
      },
        {
        "trigger": "OnDevicesOrdering",
        "target": "StateDevicesOrdered"
      },
        {
          "trigger": "OnMeasurementExpected",
          "target" : "StateWaitingMeasurement"
        }
      ]
    },
    {
      "name":"StateAppointmentBooked",
      "transitions": [{
        "trigger": "OnOneMinuteRemained",
        "target": "StateInformedNotificationSoon"
      }],
      "actions": [{
        "name": "ActionSendPatientAppointmentBookedNotification",
        "notificationTemplate":"patientAppointmentBooked"
      },
       {
        "name": "ActionSendProviderAppointmentBookedNotification",
         "notificationTemplate":"providerAppointmentBooked"
      }]
    },
    {
      "name":"StateInformedNotificationSoon",
      "transitions": [{
        "trigger": "OnReadNotificationSoon",
        "target": "StateIdle"
      }],
      "actions": []
    },
    {
      "name":"StateDevicesOrdered",
      "transitions": [{
        "trigger": "OnDevicesDispatching",
        "target": "StateDevicesDispatched"
      }],
      "actions": [{
        "name": "ActionSendDevicesOrderedNotification",
        "notificationTemplate":"devicesOrdered"
      }]
    },
    {
      "name": "StateDevicesDispatched",
      "transitions": [{
        "trigger": "OnDevicesDelivering",
        "target": "StateDevicesDelivered"
      }],
      "actions": [{
        "name": "ActionSendDevicesDispatchedNotification",
        "notificationTemplate":"devicesDispatched"
      }]
    },
    {
      "name": "StateDevicesDelivered",
      "transitions": [{
        "trigger": "OnDevicesInstalled",
        "target": "StateWaitingMeasurement"
      }],
        "actions":[{
          "name":"ActionSendInstallDevicesNotification",
          "notificationTemplate":"installDevices"
        }]
    },
    {
      "name":"StateWaitingMeasurement",
      "transitions":[{
        "trigger":"OnMeasurementReceived",
        "target":"StateIdle"
      }],
      "actions":[{
        "name":"ActionSendTakeMeasurementNotification",
        "notificationTemplate":"takeMeasurement"
      }]
    }
  ]
}